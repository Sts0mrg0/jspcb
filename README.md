# jspcb
Javascript library for parsing PCB file formats having rich metadata. 
Compatible with nodejs, jspcb can be used on the server or in the browser 
client in the context of automated pick-and-place (PnP). Supported PCB file
formats:

* <a href="file:///home/chronos/u-a7a1ed9f0b86bfc3924e4a621e22cffc1868821a/Downloads/eagle416r2_help_en.pdf">Eagle BRD (XML)</a>
* Gerber files (Altium/Protel extension semantics)
* Gerber files (generated by SparkFun sfe-gerb274x.cam for Eagle BRD)

[See the wiki](https://github.com/firepick/jspcb/wiki)

### Install
To install **jspcb** command line wrapper and dependencies:

`npm install -g jspcb`

NOTE: The above requires that your user be able to write to /usr/local. 

### Command line
#### Generate SVG file from Eagle BRD
Convert XML Eagle BRD file such as the 
<a href="https://github.com/adafruit/Adafruit-PCB-Ruler/blob/master/Adafruit%20PCB%20Reference%20Ruler.brd">AdaFruit PCB ruler</a>
into its 
<a href="https://raw.githubusercontent.com/firepick/jspcb/master/eagle/ruler.svg">SVG equivalent</a>

`jspcb --eagle eagle/ruler.brd --svg /tmp/ruler.svg`

<a href="https://raw.githubusercontent.com/firepick/jspcb/master/doc/ruler.png">
    <img src="https://raw.githubusercontent.com/firepick/jspcb/master/doc/ruler.png" height="200px"></a>

#### Generate CSV file with SMD pads
To generate a CSV file of the SMD pads:

`jspcb --eagle eagle/ruler.brd --csv-smdpads /tmp/pads.csv`

#### Generate PCB matching template
Generate a FireSight and/or OpenCV PNG matching template from Gerber files using a 
**jspcb** [JSON configuration file](https://github.com/firepick/jspcb/blob/master/json/gerber-template.json):

`jspcb --json json/gerber-template.json`

<a href="https://raw.githubusercontent.com/firepick/jspcb/master/doc/ruler-tmplt.png"> 
    <img src="https://raw.githubusercontent.com/firepick/jspcb/master/doc/ruler-tmplt.png" height=200px></a>
<a href="https://raw.githubusercontent.com/firepick/jspcb/master/doc/ruler-match.png"> 
    <img src="https://raw.githubusercontent.com/firepick/jspcb/master/doc/ruler-match.png" height=200px></a>

### Node.js usage
#### Scripts
You can use `jspcb` classes directly in a Node.js script (with NODE_PATH appropriately set to your global node_modules):

<pre>
const jspcb = require("jspcb");
const PcbTransform = jspcb.PcbTransform;

var pcbTrans = new PcbTransform({
    eagle: {
        path: "eagle/ruler.brd",
    },
});
console.log(pcbTrans.viewBounds());
</pre>

#### Web server
Do not use `jspcb` as a library from within a Node.js web applications. 
Node.js is single threaded, and you
will block your entire web application when reading in PCB files. 
Instead, install `jspcb` globally and spawn a child
process to invoke jspcb with command line arguments such as `--json-out`.
Alternatively, you can also spawn a child process to call a jspcb Node.js script as described above.
Either method will allow you to generate the output files needed by your web application.
Spawning a child process will allow Node.js to run unencumbered and 
your web application can then look for and consume the newly generated JSON file(s) as
they appear.
